<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Accueil - Fast Forward</title>
<link href="style.css" rel="stylesheet"/>
<style id="ff-bugfix">/* === Fast-Forward bugfixes (desktop overflow & mobile burger) === */
header { display:flex; align-items:center; gap:24px; padding:12px 20px; box-sizing:border-box; }
.logo { flex:0 0 auto; }
header nav { flex:1 1 auto; min-width:0; }

/* Desktop: allow wrap to avoid overflow of "CONTACT" */
@media (min-width: 961px) {
  header nav ul { display:flex; flex-wrap:wrap; gap:14px 20px; justify-content:flex-end; margin:0; padding:0; list-style:none; }
  header nav a { white-space:nowrap; text-decoration:none; }
}

/* Mobile first: menu hidden by default */
@media (max-width: 960px) {
  header { position: relative; }
  button.burger { appearance:none; border:0; background:transparent; padding:10px; cursor:pointer; }
  button.burger span { display:block; width:24px; height:2px; margin:5px 0; background:currentColor; transition:transform .2s, opacity .2s; }
  /* Hidden menu */
  header nav { display:none; }
  /* Opened state */
  header.is-open nav {
    display:block;
    position:fixed;
    top:0; right:0; bottom:0;
    width:82vw; max-width:360px;
    background:#fff;
    padding:24px 20px;
    box-shadow:-10px 0 30px rgba(0,0,0,.12);
    z-index:1001;
    overflow:auto;
  }
  /* Backdrop */
  #menu-backdrop[aria-hidden="false"] {
    position:fixed; inset:0;
    background:rgba(0,0,0,.35);
    backdrop-filter:blur(2px);
    z-index:1000;
    pointer-events:auto;
  }
  /* Burger -> X */
  button.burger[aria-expanded="true"] span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
  button.burger[aria-expanded="true"] span:nth-child(2) { opacity:0; }
  button.burger[aria-expanded="true"] span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
}
/* === /bugfixes === */
#menu-backdrop { pointer-events: none; }
#menu-backdrop[aria-hidden="false"] {
  position:fixed; inset:0;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(2px);
  z-index:1000;
  pointer-events:auto;
}

/* Affichage vidéo */
.hero video { display:block; width:100%; height:auto; background:#000; }
</style>
</head>
<body>
<header>
  <a aria-label="Fast Forward — Accueil" class="logo" href="index.html">
    <img alt="Fast Forward" class="logo-img" src="images/logo.png"/>
  </a>
  <nav aria-label="Navigation principale" id="menu">
    <ul>
      <li><a href="index.html">ACCUEIL</a></li>
      <li><a href="news.html">NEWS</a></li>
      <li><a href="livestream.html">LIVESTREAM / CAPTATION LIVE</a></li>
      <li><a href="location.html">LOCATION</a></li>
      <li><a href="consulting.html">CONSULTING</a></li>
      <li><a href="equipe.html">QUI SOMMES-NOUS</a></li>
      <li><a href="contact.html">CONTACT</a></li>
    </ul>
  </nav>
  <button aria-controls="menu" aria-expanded="false" aria-label="Menu" class="burger">
    <span></span><span></span><span></span>
  </button>
</header>

<section class="hero">
  <!-- Une seule balise <video> ; on gère la source en JS pour fiabilité mobile/iOS -->
  <video
    id="bg-video"
    autoplay
    muted
    playsinline
    webkit-playsinline
    x-webkit-airplay="allow"
    preload="auto">
    Votre navigateur ne supporte pas la vidéo.
  </video>
</section>

<section class="content-section">
  <h2>OFFREZ A VOS EVENEMENTS L’IMPACT D’UNE CAPTATION VIDEO PRO</h2>
  <p>
    Notre dispositif vidéo s’adapte à des projets d’envergure (conférences, meetings, salons) 
    comme à des projets plus confidentiels comme des webinars, visioconférences, vidéos de formation, ateliers filmés.<br/><br/>
    Fast Forward vous apporte tout son savoir-faire dans la conception vidéo. 
    Son équipe est constituée de professionnels ayant travaillé de nombreuses années en événementiel et en télévision. 
    Nous saurons répondre à vos besoins en mettant en œuvre les moyens techniques adaptés à votre projet.<br/><br/>
    Découvrez nos services.
  </p>
</section>

<script defer src="script.js"></script>
<div aria-hidden="true" id="menu-backdrop"></div>
<script id="ff-bugfix-js">
// === Fast-Forward bugfixes: burger toggle (v2) ===
document.addEventListener('DOMContentLoaded', () => {
  const header   = document.querySelector('header');
  const burger   = document.querySelector('button.burger');
  const menu     = document.getElementById('menu');
  const backdrop = document.getElementById('menu-backdrop');
  const list = menu ? menu.querySelector('ul') : null;

  function isOpen() {
    return burger && burger.getAttribute('aria-expanded') === 'true';
  }
  function setOpen(open) {
    if (list) list.classList.toggle('show', !!open);
    header?.classList.toggle('is-open', open);
    if (burger) burger.setAttribute('aria-expanded', String(open));
    if (backdrop) backdrop.setAttribute('aria-hidden', String(!open));
    document.documentElement.style.overflow = open ? 'hidden' : '';
    document.body.style.overflow = open ? 'hidden' : '';
  }

  burger?.addEventListener('click', (e) => {
    e.stopPropagation();
    setOpen(!isOpen());
  });

  backdrop?.addEventListener('click', () => setOpen(false));

  // Close on ESC
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') setOpen(false); });

  // Close when clicking any link inside the menu
  menu?.addEventListener('click', (e) => {
    const a = e.target && (e.target.closest ? e.target.closest('a') : null);
    if (a) setOpen(false);
  });

  // Close when clicking anywhere outside le menu/burger
  document.addEventListener('pointerdown', (e) => {
    if (!isOpen()) return;
    const target = e.target;
    const withinMenu = menu && (target === menu || (target.closest && target.closest('#menu')));
    const onBurger = burger && (target === burger || (target.closest && target.closest('button.burger')));
    if (!withinMenu && !onBurger) setOpen(false);
  }, true);
});
// === /bugfixes ===
</script>

<script>
// === Sélecteur vidéo desktop/mobile ultra-robuste ===
(function () {
  const video = document.getElementById('bg-video');

  // Chemins possibles (on gère parenthèses **et** variante renommée sans parenthèses)
  const SRC_DESKTOP = 'videos/ma_video.mp4';
  const MOBILE_CANDIDATES = [
    'videos/ma_video_mobile.mp4',       // si tu renommes (recommandé)
    'videos/ma_video(mobile).mp4',      // si tu gardes les parenthèses
    'videos/ma_video%28mobile%29.mp4'   // version encodée des parenthèses
  ];

  // Détection "mobile" robuste (largeur, pointeur tactile, UA)
  const mqlWidth   = window.matchMedia('(max-width: 960px)');
  const mqlPointer = window.matchMedia('(pointer: coarse)');
  function isMobileLike () {
    return mqlWidth.matches || mqlPointer.matches || /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  }

  let currentKey = ''; // 'desktop' | 'mobile'
  let currentUrl = '';

  function withBust(url, tag) {
    const qs = (url.indexOf('?') === -1 ? '?' : '&') + 'v=' + tag + '-' + Date.now();
    return url + qs;
  }

  function tryLoad(urls, tag) {
    return new Promise((resolve) => {
      let i = 0;

      const tryOne = () => {
        if (i >= urls.length) return resolve(false);

        const url = withBust(urls[i], tag);
        i++;

        // Nettoie et applique la source
        video.pause();
        video.removeAttribute('src');
        while (video.firstChild) video.removeChild(video.firstChild);
        video.src = url;
        currentUrl = url;

        let settled = false;
        const onCanPlay = async () => {
          if (settled) return;
          settled = true;
          cleanup();
          try { await video.play(); } catch (_) {}
          resolve(true);
        };
        const onError = () => {
          if (settled) return;
          cleanup();
          // Essaye le suivant
          tryOne();
        };
        const onStalledTimeout = setTimeout(() => {
          if (settled) return;
          cleanup();
          tryOne();
        }, 4000); // si rien ne se passe, on tente le suivant

        function cleanup () {
          video.removeEventListener('loadeddata', onCanPlay);
          video.removeEventListener('canplay', onCanPlay);
          video.removeEventListener('error', onError);
          clearTimeout(onStalledTimeout);
        }

        video.addEventListener('loadeddata', onCanPlay, { once:true });
        video.addEventListener('canplay', onCanPlay, { once:true });
        video.addEventListener('error', onError, { once:true });
        video.load();
      };

      tryOne();
    });
  }

  async function setForContext() {
    const wantMobile = isMobileLike();
    const wantKey = wantMobile ? 'mobile' : 'desktop';
    if (currentKey === wantKey) return;

    if (wantMobile) {
      const ok = await tryLoad(MOBILE_CANDIDATES, 'm');
      if (!ok) {
        // En dernier recours, on retombe sur la desktop pour ne pas rester en écran noir.
        await tryLoad([SRC_DESKTOP], 'd');
      }
    } else {
      await tryLoad([SRC_DESKTOP], 'd');
    }
    currentKey = wantKey;
  }

  // Initial
  setForContext();

  // Bascule live (rotation/resize/changement de pointeur)
  const onChange = () => setForContext();
  if (mqlWidth.addEventListener) {
    mqlWidth.addEventListener('change', onChange);
    mqlPointer.addEventListener('change', onChange);
  } else {
    mqlWidth.addListener(onChange);
    mqlPointer.addListener(onChange);
  }

  // Si la lecture échoue plus tard, on retente la sélection
  video.addEventListener('error', onChange);
})();
</script>

</body>
</html>
